# Overview

Introduce a simple file-based cache for π calculation results so repeated requests for the same parameters return instantly without recomputation. Users benefit from faster CLI invocations and HTTP responses when requesting identical algorithm and parameter combinations.

# Implementation

1. Cache Storage
   • Use a single JSON file in the user’s home directory or project root, named `.pi_cache.json`.
   • Structure: a top-level object mapping cache keys to result entries.
   • Cache key: a string generated by serializing algorithm name and parameters, e.g., `leibniz:digits=5` or `montecarlo:samples=100000`.

2. Integration in CLI and HTTP handlers
   a. Before computing or dispatching algorithms, attempt to read the cache file if it exists. Parse JSON into an in-memory object. On parse errors, ignore and recreate file.
   b. Compute cache key for current parameters.
   c. If a cache hit is found:
      • Return cached result immediately.
      • If diagnostics flag is set, include a flag `fromCache: true` alongside other diagnostics fields.
   d. On cache miss:
      • Perform the calculation as usual.
      • After obtaining the result and any diagnostics data, store a new entry under the computed key in the in-memory cache object, then write the updated JSON object back to the cache file.

3. Failure and concurrency handling
   • Wrap file read/write in try/catch. On write errors, log a warning and continue without failing the calculation.
   • Minimize blocking I/O by reading the cache once at application start and writing asynchronously after each new entry is created.

# Testing

1. Unit tests in tests/unit/main.test.js:
   - Mock `fs.readFileSync` and `fs.writeFileSync` to simulate an existing cache file and verify cache lookup behavior.
   - Test cache hit: prepare a cache file with a known key and ensure the calculation function is not called and cached result is returned.
   - Test cache miss: start with an empty or missing file, verify calculation is called and `fs.writeFileSync` is invoked to store the new result.
   - Test diagnostics: when `--diagnostics` is passed and a cache hit occurs, confirm the output object includes `fromCache: true`.

2. HTTP tests in tests/unit/server.test.js:
   - Mock `fs.readFileSync` to return a cache containing a value for a GET `/pi` request, then verify the response body matches the cached result and contains no new computation fields unless diagnostics is set.
   - Test that after a cache miss, a subsequent identical request returns from cache and that cache file writing is invoked.

# Documentation

1. docs/USAGE.md:
   - Add a section under **Options** describing `--cache` (boolean) CLI flag to control whether caching is enabled (default: true) and `CACHE_DISABLED` environment variable to turn off caching.
   - Show example: running `node src/lib/main.js --digits 5 --cache` then repeating the same command returns instantly.
2. README.md:
   - Add **Result Caching** under Features.
   - Describe behavior and how to disable caching if needed.
   - Provide a CLI example and note HTTP endpoints also benefit from cache.
