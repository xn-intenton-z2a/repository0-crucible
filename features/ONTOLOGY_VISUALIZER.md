# Ontology Visualizer & Diagnostic Dashboard Enhancement

This update refines the existing Ontology Visualizer feature by not only continuing to display a live-built ontology graph but also by significantly enhancing diagnostic feedback. In addition to the advanced diagnostic dashboard panel, the feature now integrates a unified Environment Variable Diagnostics subsystem that monitors, normalizes, and reports issues related to environment configuration.

## Overview

- **Interactive Graph Display:** Remains the central element to visually render live OWL ontologies with zooming, panning, and node selection capabilities.

- **Enhanced Diagnostic Dashboard Panel:** This panel now streams structured diagnostic logs along with real-time telemetry data. In addition to system logs and error/warning notifications, it includes messages related to environment variable parsing, fallback handling, and CLI override actions.

- **Telemetry Aggregator:** Captures and aggregates telemetry events including those generated by non-numeric or malformed environment variable inputs. Warnings and fallback events are logged once per unique invalid input and are exported as JSON reports for offline review.

- **Environment Variable Diagnostics Integration:** 
  - **Unified Parsing & Normalization:** Integrates a robust mechanism to normalize environment variable values (trimming whitespace, replacing any sequence of whitespace characters, and converting to lower case), ensuring that inconsistent inputs such as " NaN ", "\tNaN", or "\u00A0NaN\u00A0" are managed uniformly.
  - **CLI Override and Fallback Handling:** CLI provided override values are strictly prioritized over raw environment values. When non-numeric inputs are detected in non-strict mode, a one-time diagnostic warning is logged and a configured fallback value is used.
  - **Structured Telemetry:** Emits JSON-formatted telemetry events with fields for the raw input, normalized input, fallback value, and applicable units. This diagnostic data is accessible through the dashboard and can be filtered by log level or time.

- **Real-Time Updates:** Both ontology data and diagnostic feedback (including environment variable diagnostics) update in real time using web sockets or long polling.

## Implementation Details

- **Module Extension:** Update the existing visualization module (e.g., `src/lib/ontologyVisualizer.js`) to incorporate new UI elements dedicated to environment variable diagnostics. 

- **Diagnostic & Telemetry Integration:** Enhance diagnostic logging functions to capture not only system and application errors, but also detailed warnings from environment variable parsing routines (as implemented in the unified `parseEnvNumber` function). 

- **User-Driven Controls:** Provide CLI flags (e.g., `--strict-env`, `--livedata-retry-default`, and `--livedata-delay-default`) that allow users to control environment variable parsing behavior and immediately see the impact on diagnostics. In the UI, toggles allow users to filter, export, and review environment telemetry data.

## Testing & Diagnostics

- **Unit & Integration Tests:** Develop comprehensive tests to ensure that environment variable inputs are normalized correctly, that fallback values are applied and logged appropriately, and that telemetry events are emitted only once per unique invalid input.

- **Performance & Edge Cases:** Run tests covering a variety of invalid and extreme environment inputs to ensure that the diagnostic dashboard remains responsive. Test that CLI overrides properly replace environment configurations.

This enhancement reinforces the mission of delivering live data insights while providing developers with robust, real-time diagnostic and configuration feedback, thereby improving system reliability and maintainability.