# PLANNING

## Overview
Planning is the agent’s ability to strategize its actions by formulating a sequence of steps before execution. This AGI-aligned trait enables the system to deal with complex tasks by first outlining what needs to be done, rather than diving in blindly. In our JavaScript CLI/Lambda library context, a planning feature means the agent can take a high-level request and map out an ordered list of sub-tasks or checkpoints. This provides clarity on *how* the goal will be achieved and can prevent errors (or unnecessary work) by anticipating the requirements of each step. In essence, planning turns an arbitrary request into a coherent game plan for the agent to follow.

## Implementation Details
- **Plan Mode Trigger:** Introduce a mechanism to activate “planning mode” for the agent. For example, add a CLI flag `--plan` (or reuse the existing `--dry-run` flag) that, when present, causes the program to output a plan of actions *instead of* immediately executing the commands. In `main.js`, check for this flag in the `main` function’s arguments and set a boolean like `planningMode`. When `planningMode` is true, the agent will generate and display the intended steps.
- **Generating a Plan:** Modify `agenticHandler` (or the CLI handling logic) so that if planning mode is on, the input command or goal is analyzed and broken down into sub-steps *without executing them*. A simple implementation could take a compound command (e.g., “do X and then do Y”) and split it by known conjunctions (`and then`) or punctuation. Each part becomes a step in the plan. The agent would then output a structured list of these steps (for example, an array of step descriptions, or just log them in order with a "Plan:" prefix) and skip the actual action execution.
- **Dry-Run Integration:** Leverage the `--dry-run` flag (documented in README) as a planning tool. Currently, `--dry-run` likely prevents side-effects; we can extend it so that it not only avoids making changes but explicitly prints out what *would* have been done. For instance, if the input is a batch of commands, the dry-run output can list each command with a message “(dry-run) Would execute: [command]”. This repurposes an existing feature for planning, keeping changes minimal.
- **Testing the Plan:** Add unit tests to confirm planning behavior. One test could call the CLI entry (`agenticLib.main`) with `--plan` and a sample command, then inspect the console output (using a spy) to ensure it contains an ordered list of sub-actions rather than actual results. Another test could verify that in planning mode the agent does not modify any state (e.g., `globalThis.callCount` remains zero if we decide not to count planned actions). If using `--dry-run` for this, ensure a test covers that dry-run now outputs the plan messages.
- **README Updates:** In README.md, describe how to use the planning mode. Provide an example: “Using the `--plan` flag will show the steps the agent intends to take. For example: `node src/lib/main.js --plan --agentic '{"command": "do X and then do Y"}'` might output a plan like 1) do X, 2) do Y, without executing them.” This helps users understand the new capability. Also clarify that this is an initial planning feature – it creates a straightforward sequence from the input, but does not involve elaborate AI reasoning yet.

## Long-Term Direction
As this planning feature matures, the agent can move from simple static splitting of commands towards AI-driven planning. In the future, the agent could use the language model itself to generate an optimal plan given a complex goal (incorporating something like a chain-of-thought prompt where the model lists steps before execution). With a larger context window available, the agent could take into account its entire memory and mission when planning, leading to more globally coherent strategies. Moreover, planning could be extended to multi-session scenarios – for instance, planning an upgrade over several GitHub issues/commits. We might also see an **orchestration layer** or a forked planning SDK that allows the agent to coordinate plans across multiple agents or services. Ultimately, robust planning will ensure the agent tackles tasks methodically, improving reliability for complex, multi-faceted development objectives.
